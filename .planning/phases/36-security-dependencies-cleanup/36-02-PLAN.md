---
phase: 36-security-dependencies-cleanup
plan: 02
type: execute
wave: 1
depends_on: []
files_modified:
  - package.json
  - pnpm-lock.yaml
  - src-tauri/Cargo.toml
  - src-tauri/Cargo.lock
autonomous: true
requirements: [FIX-15, FIX-16]

must_haves:
  truths:
    - "All safe npm patch and minor updates are applied and build passes"
    - "Major npm updates are either applied or explicitly deferred with rationale"
    - "Tauri ecosystem is updated to latest 2.x coordinated across Cargo.toml and package.json"
    - "Cargo dependencies with available fixes (bytes, time) are updated; unfixable crates documented"
  artifacts:
    - path: "package.json"
      provides: "Updated npm dependencies"
    - path: "pnpm-lock.yaml"
      provides: "Locked dependency tree after updates"
    - path: "src-tauri/Cargo.toml"
      provides: "Updated Rust dependencies"
    - path: "SECURITY.md"
      provides: "Documentation of tracked Cargo vulnerabilities"
      contains: "rkyv"
  key_links:
    - from: "package.json"
      to: "pnpm-lock.yaml"
      via: "pnpm install"
      pattern: "pnpm install"
    - from: "src-tauri/Cargo.toml"
      to: "src-tauri/Cargo.lock"
      via: "cargo update"
      pattern: "cargo update"
---

<objective>
Update all project dependencies: npm patch+minor+major packages, Cargo crates with available fixes, and the Tauri ecosystem to latest 2.x. Document unfixable Cargo vulnerabilities.

Purpose: Closes DEP-001, DEP-002, DEP-003, DEP-004 from AUDIT-REPORT.md — brings all dependencies to latest compatible versions with verified builds.
Output: Updated package.json, Cargo.toml, lock files, and SECURITY.md dependency tracking.
</objective>

<execution_context>
@C:/Users/Boris/.claude/get-shit-done/workflows/execute-plan.md
@C:/Users/Boris/.claude/get-shit-done/templates/summary.md
</execution_context>

<context>
@.planning/PROJECT.md
@.planning/ROADMAP.md
@.planning/STATE.md
@package.json
@src-tauri/Cargo.toml
@SECURITY.md
@AUDIT-REPORT.md
</context>

<tasks>

<task type="auto">
  <name>Task 1: Update all npm dependencies (patch, minor, and major)</name>
  <files>package.json, pnpm-lock.yaml</files>
  <action>
Update npm dependencies in three stages, verifying the build after each.

**Stage 1 — Patch updates (safe):**
Run `pnpm update` to apply all semver-compatible patch updates. These should be risk-free.
Run `pnpm build` to verify.

**Stage 2 — Minor updates:**
Update each minor-version package individually or in small batches:
- `@tailwindcss/vite` 4.1.x -> 4.2.x (with `tailwindcss` 4.1.x -> 4.2.x together — must stay in sync)
- `@tauri-apps/api` 2.9.x -> 2.10.x (coordinate with Tauri ecosystem in Task 2)
- `@tauri-apps/cli` 2.9.x -> 2.10.x (coordinate with Tauri ecosystem in Task 2)
- `@tauri-apps/plugin-dialog` 2.4.x -> 2.6.x
- `@tauri-apps/plugin-updater` 2.9.x -> 2.10.x
- `openai` 6.15.x -> 6.22.x
- `typescript-eslint` 8.51.x -> 8.56.x
- `motion` 12.33.x -> 12.34.x

Run `pnpm build` after each batch to catch breakage early.

**Stage 3 — Major updates (apply or defer):**
Evaluate each major update:

1. `@eslint/js` 9.x -> 10.x + `eslint` 9.x -> 10.x: **DEFER** — ESLint 10 is a major rewrite with flat config migration. Requires eslint.config.js rewrite. Defer to next milestone.
2. `jsdom` 25.x -> 28.x: **DEFER** — Major version jump (25->28), dev-only, vitest handles jsdom internally. Risk of breaking test environment. Defer.
3. `react-dropzone` 14.x -> 15.x: **DEFER** — Production dependency used in BulkImportWizard. v15 likely has breaking API changes requiring component updates. Defer to next milestone.
4. `@types/node` 24.x -> 25.x: **APPLY** — Type-only package, no runtime impact. Apply and verify build.
5. `globals` 16.x -> 17.x: **APPLY** if compatible with current eslint 9.x. If eslint 9 requires globals 16.x, **DEFER** with eslint.
6. `eslint-plugin-react-refresh` 0.4.x -> 0.5.x: **APPLY** if compatible with eslint 9.x. Otherwise **DEFER** with eslint.

For each deferred major update, add a comment in the commit message explaining the rationale.

Run `pnpm build` and `pnpm test` after all updates to verify nothing is broken.
  </action>
  <verify>
1. `pnpm outdated` shows no patch/minor updates remaining (only deferred majors)
2. `pnpm build` passes with zero errors
3. `pnpm test` passes (test suite green)
4. `pnpm audit` shows no new vulnerabilities introduced
  </verify>
  <done>All npm patch and minor updates applied. @types/node major applied. ESLint v10, jsdom v28, and react-dropzone v15 explicitly deferred. Build and tests pass.</done>
</task>

<task type="auto">
  <name>Task 2: Update Cargo dependencies and Tauri ecosystem</name>
  <files>src-tauri/Cargo.toml, src-tauri/Cargo.lock, SECURITY.md</files>
  <action>
**Step 1 — Update Tauri ecosystem in Cargo.toml:**

Update the Tauri core and plugin versions to latest 2.x:
- `tauri` from `2.9.5` to `2.10.x` (latest)
- `tauri-build` from `2.5.3` to latest 2.x
- `tauri-plugin-updater` from `"2"` — keep as `"2"` (semver range already picks latest)
- `tauri-plugin-dialog` from `"2"` — keep as `"2"`
- `tauri-plugin-fs` from `"2"` — keep as `"2"`
- All other `tauri-plugin-*` entries use `"2"` which auto-resolves.

For the pinned `tauri` and `tauri-build` entries, update to specific latest versions:
- `tauri = { version = "2.10", features = ["tray-icon", "devtools"] }`
- `tauri-build = { version = "2.10", features = [] }`

**Step 2 — Update transitive Cargo crates:**

Run `cargo update` in `src-tauri/` to pull latest compatible versions. This should pick up:
- `bytes` fix (>=1.11.1) if Tauri upstream has updated
- `time` fix (>=0.3.41) if Tauri upstream has updated

After `cargo update`, run `cargo audit` to check remaining vulnerabilities.

**Step 3 — Document tracked Cargo vulnerabilities in SECURITY.md:**

Update the "Dependency Security" > "Current exceptions" section in SECURITY.md to document the Cargo crate status:
- **bytes**: Note whether the fix was pulled in by cargo update, or if it's still blocked by upstream Tauri.
- **time**: Same — note resolution status.
- **rkyv 0.7.x**: Unmaintained, no fix available. Transitive via Tauri. Document as tracked upstream with no action available.
- **rsa 0.9.x**: No 0.9.x patch. Transitive via Tauri TLS stack. Document as tracked upstream.

**Step 4 — Verify build:**
Run `pnpm tauri build` (or at minimum `cd src-tauri && cargo build`) to verify Rust compilation succeeds with updated dependencies.
If `pnpm tauri build` fails due to Tauri process lock, use `cargo build --release` in src-tauri as alternative verification.
  </action>
  <verify>
1. `src-tauri/Cargo.toml` shows `tauri = "2.10"` (or latest 2.x)
2. `cargo build` in src-tauri compiles without errors
3. `cargo audit` output reviewed — remaining vulns are documented in SECURITY.md
4. SECURITY.md "Current exceptions" section covers bytes, time, rkyv, rsa status
  </verify>
  <done>Tauri ecosystem updated to 2.10.x in both Cargo.toml and package.json. cargo update applied. Remaining Cargo vulnerabilities documented in SECURITY.md with tracking status.</done>
</task>

</tasks>

<verification>
1. `pnpm build` passes with zero TypeScript errors
2. `pnpm test` passes (test suite green)
3. `pnpm outdated` shows only explicitly deferred major packages
4. `cargo build` in src-tauri compiles successfully
5. SECURITY.md documents tracked Cargo vulnerabilities
6. No new npm audit vulnerabilities introduced
</verification>

<success_criteria>
- All 10+ npm patch updates applied
- All 10+ npm minor updates applied
- Major updates: @types/node applied, eslint/jsdom/react-dropzone deferred with rationale
- Tauri ecosystem at 2.10.x (Cargo.toml + package.json synchronized)
- Cargo crates updated where fixes available; unfixable tracked in SECURITY.md
- `pnpm build` and `cargo build` both pass
</success_criteria>

<output>
After completion, create `.planning/phases/36-security-dependencies-cleanup/36-02-SUMMARY.md`
</output>
