---
phase: 34-dead-code-sweep
plan: 01
type: execute
wave: 1
depends_on: []
files_modified:
  - src/components/consent/ConsentDialog.tsx
  - src/lib/ai-telemetry.ts
  - src/lib/ai-provider-registry.ts
  - src/components/ui/Badge.tsx
  - src/components/ui/index.ts
  - src/components/settings/MaintenanceModal.tsx
  - src/constants/storage.ts
  - src/components/welcome/WelcomePage.tsx
  - src/lib/ai-context.ts
  - src/test-utils/stress-helpers.ts
autonomous: true
gap_closure: true
requirements: [FIX-05, FIX-08]
must_haves:
  truths:
    - "No unused exports remain in ai-telemetry.ts, ai-provider-registry.ts, Badge.tsx, or constants/storage.ts"
    - "ConsentDialog.tsx has a single merged import from tauri-bridge"
    - "WelcomePage.tsx uses LogoIcon, FolderOpenIcon, SpinnerIcon from Icons.tsx — no local SVG duplicates"
    - "MaintenanceModal.tsx is deleted from the codebase"
    - "ai-context.ts console.log statements are removed or guarded by import.meta.env.DEV"
    - "mockIpcWithState is removed from stress-helpers.ts"
    - "pnpm build passes with zero TypeScript errors"
  artifacts:
    - path: "src/components/consent/ConsentDialog.tsx"
      provides: "Single merged tauri-bridge import"
    - path: "src/lib/ai-telemetry.ts"
      provides: "clearTelemetry and getRecentTelemetry removed"
    - path: "src/lib/ai-provider-registry.ts"
      provides: "getBuiltInProvider and getDefaultModelForProvider removed"
    - path: "src/components/ui/index.ts"
      provides: "DynamicBadge removed from barrel export"
    - path: "src/components/welcome/WelcomePage.tsx"
      provides: "Local icons replaced with imports from Icons.tsx"
    - path: "src/lib/ai-context.ts"
      provides: "Console.log removed or DEV-guarded"
    - path: "src/constants/storage.ts"
      provides: "getProjectAIConfigKey function removed"
  key_links:
    - from: "src/__tests__/components.test.tsx"
      to: "src/components/ui/Badge.tsx"
      via: "Direct import of DynamicBadge (test still works, badge not removed from Badge.tsx)"
      pattern: "import.*DynamicBadge.*from.*Badge"
---

<objective>
Remove all dead code findings DEAD-001 through DEAD-009, DEAD-011 from AUDIT-REPORT.md and orphaned mockIpcWithState export (FIX-08).

Purpose: Eliminate unused exports, stale imports, duplicated icons, and unguarded console.log to reduce bundle size and prevent maintenance confusion. DEAD-004 and DEAD-010 are handled in Plan 02 (telemetry.ts and ai.ts file ownership).
Output: 10 files cleaned, 1 file deleted (MaintenanceModal.tsx), zero TypeScript errors.
</objective>

<execution_context>
@C:/Users/Boris/.claude/get-shit-done/workflows/execute-plan.md
@C:/Users/Boris/.claude/get-shit-done/templates/summary.md
</execution_context>

<context>
@.planning/PROJECT.md
@.planning/ROADMAP.md
@.planning/STATE.md
@AUDIT-REPORT.md
@src/components/consent/ConsentDialog.tsx
@src/lib/ai-telemetry.ts
@src/lib/ai-provider-registry.ts
@src/components/ui/Badge.tsx
@src/components/ui/index.ts
@src/components/settings/MaintenanceModal.tsx
@src/constants/storage.ts
@src/components/welcome/WelcomePage.tsx
@src/lib/ai-context.ts
@src/test-utils/stress-helpers.ts
@src/components/ui/Icons.tsx
</context>

<tasks>

<task type="auto">
  <name>Task 1: Remove unused exports and merge duplicate imports (DEAD-001, DEAD-002, DEAD-003, DEAD-005, DEAD-007)</name>
  <files>
    src/components/consent/ConsentDialog.tsx
    src/lib/ai-telemetry.ts
    src/lib/ai-provider-registry.ts
    src/components/ui/Badge.tsx
    src/components/ui/index.ts
    src/constants/storage.ts
  </files>
  <action>
    **DEAD-001: ConsentDialog.tsx** — Merge the two tauri-bridge imports (lines 12-13) into a single import:
    ```typescript
    import { isTauri, openExternalUrl } from '../../lib/tauri-bridge';
    ```
    Remove the second import line.

    **DEAD-002: ai-telemetry.ts** — Delete the `clearTelemetry` function (starts around line 209) and the `getRecentTelemetry` function (starts around line 227). Both are exported but never imported by any file. Remove the entire function bodies including JSDoc comments. Check if removing these functions leaves any unused imports at the top of the file and clean those up too.

    **DEAD-003: ai-provider-registry.ts** — Delete the `getBuiltInProvider` function (line 144-150) and the `getDefaultModelForProvider` function (line 164-167). Both are exported but never imported. `getBuiltInProvider` is superseded by `getProviderById` and `isBuiltInProvider`. `getDefaultModelForProvider` is superseded by `resolveModelForProvider` in ai.ts. Remove entire function bodies including JSDoc. Do NOT remove `isBuiltInProvider` (line 156) — it is actively used.

    **DEAD-005: Badge.tsx + ui/index.ts** — Remove `DynamicBadge` from the barrel export in `src/components/ui/index.ts` (line 52). Change `export { Badge, DynamicBadge } from './Badge'` to `export { Badge } from './Badge'`. Do NOT remove `DynamicBadge` from Badge.tsx itself — it is still imported directly by `src/__tests__/components.test.tsx` (the test imports from `'../components/ui/Badge'`, not from the barrel).

    **DEAD-007: constants/storage.ts** — Delete the `getProjectAIConfigKey` function (lines 109-112) including its JSDoc comment. This function is defined but never imported anywhere. The `PROJECT_AI_CONFIG_PREFIX` constant in STORAGE_KEYS can remain (it may be used for cleanup logic later).
  </action>
  <verify>
    Run `pnpm build` — must pass with zero errors.
    Grep for `clearTelemetry`, `getRecentTelemetry`, `getBuiltInProvider`, `getDefaultModelForProvider`, `getProjectAIConfigKey` across src/ — none should appear as imports (only as definitions in test files or the defining file itself is acceptable for DynamicBadge).
  </verify>
  <done>
    ConsentDialog has single merged tauri-bridge import. ai-telemetry.ts has no clearTelemetry or getRecentTelemetry exports. ai-provider-registry.ts has no getBuiltInProvider or getDefaultModelForProvider exports. DynamicBadge removed from barrel ui/index.ts. getProjectAIConfigKey deleted from storage.ts. Build passes.
  </done>
</task>

<task type="auto">
  <name>Task 2: Remove orphaned components, replace local icons, guard console.log, remove mockIpcWithState (DEAD-006, DEAD-009, DEAD-011, FIX-08)</name>
  <files>
    src/components/settings/MaintenanceModal.tsx
    src/components/welcome/WelcomePage.tsx
    src/lib/ai-context.ts
    src/test-utils/stress-helpers.ts
  </files>
  <action>
    **DEAD-006: MaintenanceModal.tsx** — Delete the entire file `src/components/settings/MaintenanceModal.tsx`. It is orphaned — never imported by any other file. Product decision (from AUDIT-REPORT.md): remove, it has been disabled since v1.5. Verify no imports reference it before deleting by grepping for `MaintenanceModal` across the codebase.

    **DEAD-009: WelcomePage.tsx** — Replace local icon definitions (lines 366-393) with imports from Icons.tsx.

    Step 1: Add imports at the top of WelcomePage.tsx alongside existing imports:
    ```typescript
    import { LogoIcon, FolderOpenIcon, SpinnerIcon } from '../ui/Icons';
    ```

    Step 2: Delete the local function definitions for `LogoIcon` (lines 366-372), `FolderOpenIcon` (lines 375-382), and `SpinnerIcon` (lines 384-392). Keep `ErrorIcon` and `CloseSmallIcon` — check if they exist in Icons.tsx. If they do, import them too and remove the local definitions. If they do NOT exist in Icons.tsx, leave the local definitions in place.

    Step 3: Also delete the section header comment `// ============================================================ // ICONS // ============================================================` if ALL icons below it are removed. If some local icons remain, keep the header.

    **DEAD-011: ai-context.ts** — Remove or guard the 3 `console.log` statements in the production code path:
    - Line ~387: `console.log('[AI Context] Loaded: ...')` — wrap with `if (import.meta.env.DEV)`
    - Line ~487: `console.log('[AI Context] No context files found...')` — wrap with `if (import.meta.env.DEV)`
    - Line ~491: `console.log('[AI Context] Injecting context into prompt:', ...)` — wrap with `if (import.meta.env.DEV)`

    Note: The `console.warn` on line ~498 should remain as-is (it logs actual errors, not debug info).

    **FIX-08: stress-helpers.ts** — Delete the `mockIpcWithState` function (lines 407-417) and its JSDoc comment (lines ~396-406). It is exported but has zero consumers (no file imports it). Also remove the `StatefulSqlMock` type reference in its signature — check if `StatefulSqlMock` is used elsewhere in the file. If yes, keep the type. If `mockIpcWithState` is its only consumer, remove the type too.
  </action>
  <verify>
    Run `pnpm build` — must pass with zero errors.
    Verify MaintenanceModal.tsx no longer exists: `ls src/components/settings/MaintenanceModal.tsx` should fail.
    Grep for `mockIpcWithState` — should only appear in git history, not in any source file.
    Grep for unguarded `console.log` in ai-context.ts — should return only lines inside `if (import.meta.env.DEV)` blocks.
  </verify>
  <done>
    MaintenanceModal.tsx deleted. WelcomePage.tsx uses imported icons from Icons.tsx (no local SVG duplicates for LogoIcon, FolderOpenIcon, SpinnerIcon). ai-context.ts console.log guarded with import.meta.env.DEV. mockIpcWithState removed from stress-helpers.ts. Build passes.
  </done>
</task>

</tasks>

<verification>
1. `pnpm build` passes with zero TypeScript errors
2. Grep across src/ for each removed symbol confirms no orphaned imports
3. `MaintenanceModal.tsx` file is deleted
4. `WelcomePage.tsx` imports LogoIcon, FolderOpenIcon, SpinnerIcon from Icons.tsx
5. `ai-context.ts` has no unguarded console.log in production code
6. `mockIpcWithState` does not appear in any src/ file
7. Existing test suite (`pnpm test`) still passes — DynamicBadge tests import directly from Badge.tsx, not from barrel
</verification>

<success_criteria>
- 10 DEAD-xxx findings resolved (DEAD-001, 002, 003, 005, 006, 007, 009, 011 + partial DEAD-008 already done in Phase 33)
- FIX-08 (mockIpcWithState orphaned export) resolved
- Zero TypeScript build errors
- No unused exports remain in the touched files
</success_criteria>

<output>
After completion, create `.planning/phases/34-dead-code-sweep/34-01-SUMMARY.md`
</output>
